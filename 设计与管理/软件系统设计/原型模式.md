---
aliases: 
date created: 2023-04-16 16:04:00
date modified: 2024-03-20 11:03:83
title: 原型模式
tags: [software-design/pattern]
---

## 定义

原型模式 (Prototype Pattern)：原型模式是一种对象创建型模式，用原型实例指定创建对象的种类，并且通过复制这些原型创建新的对象。**原型模式允许一个对象再创建另外一个可定制的对象，无须知道任何创建的细节**。

## 结构

1. Prototype：抽象原型类
2. ConcretePrototype：具体原型类
3. Client：客户类
![](https://spricoder.oss-cn-shanghai.aliyuncs.com/2021-Software-System-Design/img/lec04/4.png)

## 分析

### 优点
1. 原型模式可以快速创建很多相同或相似的对象，简化对象的创建过程 (对于复杂对象)，提供了简化的创建结构
2. 可以动态增加或减少产品类
3. 可以使用深克隆保存对象的状态

### 缺点
1.  每个类都需要提供克隆方法，必须修改类的源代码，**违反**[[开闭原则]]
2.  实现深克隆时需要编写较为复杂的代码

### 适用场景
1. 创建新对象的成本较大。使用复制可以降低成本。
2. 如果系统需要保存对象状态时，如果对象状态变化小或占用内存较少，可以使用原型模式配合备忘录模式。如果对象状态变化较大，则使用状态模式。
3. 需要通过避免使用分层次的工厂类来创建分层次的对象，且类的实例只有一个或较少状态时，使用复制比使用构造更好

#### 实例：邮件复制（浅克隆）
由于邮件对象包含的内容较多（如发送者、接收者、标题、内容、日期、附件等），某系统中现需要提供一个邮件复制功能，对于已经创建好的邮件对象，可以通过复制的方式创建一个新的邮件对象，如果需要改变某部分内容，无须修改原始的邮件对象，只需要修改复制后得到的邮件对象即可。使用原型模式设计该系统。在本实例中使用浅克隆实现邮件复制，即复制邮件 (Email)的同时不复制附件 (Attachment)。
![](https://spricoder.oss-cn-shanghai.aliyuncs.com/2021-Software-System-Design/img/lec04/5.png)