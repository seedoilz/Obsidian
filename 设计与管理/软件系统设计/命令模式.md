---
aliases: [Command Pattern]
date created: 四月 17日 2023, 2:49:34 下午
date modified: 三月 5日 2024, 4:07:11 下午
title: 命令模式
tags: [software-design/pattern]
---

## 定义
命令模式 (Command Pattern)：**将一个请求封装为一个对象**，从而使我们可用**不同的请求对客户进行参数化**；**对请求排队或者记录请求日志，以及支持可撤销的操作**。命令模式是一种**对象行为型模式**，其别名为动作 (Action)模式或事务 (Transaction)模式。

## 结构
<font color="#9bbb59">（Invoker和Client不是同一个人）</font>
1. Command: 抽象命令类
2. ConcreteCommand: 具体命令类
3. Invoker: 调用者
4. Receiver: 接收者
5. Client: 客户类
![](https://spricoder.oss-cn-shanghai.aliyuncs.com/2021-Software-System-Design/img/lec05/7.png)

## 分析
1. 命令模式的本质是**对命令进行封装**，**将发出命令的责任和执行命令的责任分割开**。
2. 每一个命令都是一个操作：**请求的一方发出请求，要求执行一个操作；接收的一方收到请求，并执行操作**。
3. 命令模式允许请求的一方和接收的一方独立开来，**使得请求的一方不必知道接收请求的一方的接口**，更不必知道请求是怎么被接收，以及操作是否被执行、何时被执行，以及是怎么被执行的。
4. 命令模式**使请求本身成为一个对象**，这个对象和其他对象一样可以被存储和传递。
5. 命令模式的关键在于**引入了抽象命令接口**，且**发送者针对抽象命令接口编程**，只有实现了抽象命令接口的**具体命令才能与接收者相关联**。

### 优点
1.  降低系统的耦合性
2.  新的命令可以更容易的加入系统
3.  可以更容易设计命令队列和宏命令(组合命令)
4.  可以方便的实现对请求的 undo 和redo

### 缺点
1. 导致系统有过多的命令类(每一个命令对应一个命令类)

### 适用场景
1. 系统需要将请求调用者和请求接收者解耦 (调用者和接收者不直接交互)
2. 系统需要在不同时间指定请求、将请求排队和执行请求
3. 系统需要支持命令的撤销和重做操作。
4. 系统需要将一组操作组合在一起 (支持宏命令)

#### 实例
电视机是请求的接收者，遥控器是请求的发送者，遥控器上有一些按钮，不同的按钮对应电视机的不同操作。抽象命令角色由一个命令接口来扮演，有三个具体的命令类实现了抽象命令接口，这三个具体命令类分别代表三种操作：打开电视机、关闭电视机和切换频道。显然，电视机遥控器就是一个典型的命令模式应用实例。
![](https://spricoder.oss-cn-shanghai.aliyuncs.com/2021-Software-System-Design/img/lec05/9.png)