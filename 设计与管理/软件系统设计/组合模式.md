---
aliases: [Composite Pattern]
date created: 2023-04-17 15:04:00
date modified: 2024-03-20 11:03:77
title: 组合模式
tags: [software-design/pattern]
---

## 定义
1. 组合模式 (Composite Pattern)：组合多个对象形成**树形结构**以**表示"整体-部分"的结构层次**。组合模式对**单个对象（即叶子对象）**和**组合对象（即容器对象）**的**使用具有一致性**。
2. 组合模式又可以称为**整体-部分 (Part-Whole)模式**，属于对象的结构模式，它**将对象组织到树结构中，可以用来描述整体与部分的关系**。

## 结构
1. Component: 抽象构件
2. Leaf: 叶子构件
3. Composite: 容器构件
4. Client: 客户类
![](https://spricoder.oss-cn-shanghai.aliyuncs.com/2021-Software-System-Design/img/lec07/10.png)

## 分析
### 优点
1. 清晰地定义**分层次的复杂对象**，表示对象的全部层次，易于添加新构件。
2. 客户端调用简单，**客户端可以一致的使用组合结构或其中单个对象**
3. 定义包含叶子对象和容器对象的**类层次结构**，叶子可以被组合为容器，容器也可以组合成更复杂的容器，递归组成复杂的树结构。
4. **更容易在组合体内加入对象构建**，避免加入新对象构件而修改代码

### 缺点
1. **设计变得抽象**，业务逻辑比较复杂时实现组合模式有很大挑战 (不是所有的方法都与叶子对象子类有关联)
2. 增加新构建时可能产生一些问题，**很难对容器中的构建类型进行限制**。

### 适用场景
1. 需要表示一个**对象整体或部分层次**，在具有整体和部分的层次结构中，希望通过一种方式忽略整体与部分的差异，可以一致地对待它们。
2. 让客户能够忽略不同对象层次的变化，**客户端可以针对抽象构件编程，无须关心对象层次结构的细节**。
3. **对象的结构是动态的并且复杂程度不一样，但客户需要一致地处理它们**。

#### 实例
文件有不同类型，不同类型的文件其浏览方式有所区别，如文本文件和图片文件的浏览方式就不相同。对文件夹的浏览实际上就是对其中所包含文件的浏览，而客户端可以一致地对文件和文件夹进行操作，无须关心它们的区别。使用组合模式来模拟文件的浏览操作。
![](https://spricoder.oss-cn-shanghai.aliyuncs.com/2021-Software-System-Design/img/lec07/13.png)