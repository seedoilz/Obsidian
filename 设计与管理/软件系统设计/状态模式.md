---
aliases: [State Pattern]
date created: 2023-04-17 14:04:00
date modified: 2024-03-20 11:03:78
title: 状态模式
tags: [software-design/pattern]
---

## 定义
状态模式 (State Pattern)：**允许一个对象在其内部状态改变时改变它的行为**，对象看起来似乎修改了它的类。其别名为状态对象 (Objects for States)，状态模式是一种对象行为型模式。

## 结构
1. Context: 环境类
2. State: 抽象状态类
3. ConcreteState: 具体状态类
![](https://spricoder.oss-cn-shanghai.aliyuncs.com/2021-Software-System-Design/img/lec05/2.png)

## 分析
### 优点
1. 封装了转换规则
2. 枚举了可能的状态 (需要先确认状态的种类)
3. 方便增加状态 (状态的行为集中)
4. 允许状态转换逻辑与状态对象合成一体 (而不是复杂条件语句)
5. 允许多个环境对象共享一个状态对象，减少对象的个数

### 缺点
1. 增加类和对象的个数
2. 结构和实现复杂，实现不当容易导致程序结构和代码的混乱
3. 对[[开闭原则]]**的支持不好**，增加状态类需要修改状态切换代码，修改行为也需要修改对应状态类的代码

### 适用场景
1.  对象行为依赖于它的状态(属性)并且可以根据状态改变而改变行为。
2.  代码中包含大量与对象状态相关的条件语句，导致代码的低可维护性、灵活性和高耦合，不能方便地删除和增加状态。

#### 实例
在某论坛系统中，用户可以发表留言，发表留言将增加积分；用户也可以回复留言，回复留言也将增加积分；用户还可以下载文件，下载文件将扣除积分。该系统用户分为三个等级，分别是新手、高手和专家，这三个等级对应三种不同的状态，这三种状态分别有不同的转化规律以及不同。
![](https://spricoder.oss-cn-shanghai.aliyuncs.com/2021-Software-System-Design/img/lec05/5.png)