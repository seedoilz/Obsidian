---
aliases: 
date created: 四月 30日 2023, 3:31:33 下午
date modified: 三月 10日 2024, 9:30:05 晚上
title: 模型评估与选择
tags:
  - input
---
## 评估方法
### 留出法
将样本随机划分成两个部分——测试部分和训练部分。
一般可能会采用多次随机分割，来减小偏差。

### 交叉验证方法
>软工 3 中的 SentiStrength 项目采用了这个。
#### 定义
k-fold cross validation
将数据集 D 划分为 k 个大小相似的互斥子集。然后，每次用 k-1 个子集的并集作为训练集，余下的那个子集作为测试集; 这样就可获得 k 组训练/ 测试集，从而可进行 k 次训练和测试，最终返回的是这 k 个测试结果的均值。

#### 衍生
##### 多次分割
在分割的时候采用多次分割，例如“10次10折交叉验证”——一共可以训练 100 次。

##### 留一法(Leave-One -Out，简称 LOO )
假设数据集中有 m 个样本，令 k=m。但只适用于数据集较小的模型。

### 自助法
>bootstrapping

给定包含 m 个样本的数据集，每次随机从 D 中挑选一个样本，将其放入 D' 中，并将样本**放回**。共取 m 个。
在数据量足够的情况下不会使用这个方法。

## 性能度量
### 查准率、查全率与 F1
查准率（准确率）**P**:被学习器预测为正例的样例中有多大比例是真正例。
查全率（召回率）**R**:所有正例当中有多大比例被学习器预测为正例。
F1 是查准率和查全率的调和平均数。
$$\frac{1}{F1}  = \frac{1}{P} + \frac{1}{R}$$
### ROC 与 AUC
threshold (阈值)
根据学习器的预测结果对样例对样例进行排序，按此顾序逐个把样本作为正例进行预测，每次计算 出两个重要量的值，分别以它们为横、纵坐标作图。
$TPR = \frac{TP}{TP+FN}$  $FPR=\frac{FP}{TN+FP}$
![image.png](https://typora-tes.oss-cn-shanghai.aliyuncs.com/picgo/20230430164948.png)
![image.png](https://typora-tes.oss-cn-shanghai.aliyuncs.com/picgo/20230430165302.png)
>AUC 是面积

### 代价敏感错误率
将错误同等对待是不可取的，例如：将无疾病-->有疾病只是增多了检查，但有疾病-->无疾病却是增加了生命危险。以二分类为例，由此引入了“代价矩阵”（cost matrix）。
![16.png](https://i.loli.net/2018/10/17/5bc71ed6ed582.png)

在非均等错误代价下，我们希望的是最小化“总体代价”，这样“代价敏感”的错误率（2.5.1节介绍）为：

![17.png](https://i.loli.net/2018/10/17/5bc71ed70bebe.png)

同样对于ROC曲线，在非均等错误代价下，演变成了“代价曲线”，代价曲线横轴是取值在\[0,1\]之间的正例概率代价，式中p表示正例的概率，纵轴是取值为\[0,1\]的归一化代价。

![18.png](https://i.loli.net/2018/10/17/5bc71ed6e952e.png)

![19.png](https://i.loli.net/2018/10/17/5bc71ed6eee7b.png)

代价曲线的绘制很简单：设ROC曲线上一点的坐标为(TPR，FPR) ，则可相应计算出FNR，然后在代价平面上绘制一条从(0，FPR) 到(1，FNR) 的线段，线段下的面积即表示了该条件下的期望总体代价；如此将ROC 曲线土的每个点转化为代价平面上的一条线段，然后取所有线段的下界，围成的面积即为在所有条件下学习器的期望总体代价，如图所示：

![20.png](https://i.loli.net/2018/10/17/5bc71ed716e0d.png)
## 比较检验
