---
aliases: 
tags:
  - code/algorithm
title: 协同过滤流程
date created: 2024-12-15 12:12:00
date modified: 2024-12-15 12:12:54
---
# 协同过滤流程

## 一、数据收集
收集用户对物品的评分、浏览记录、购买记录等行为数据，构建用户-物品矩阵，其中行代表用户，列代表物品，矩阵中的元素表示用户对物品的行为反馈（如评分）。

## 二、计算用户相似度
1. **基于向量的相似度计算**
    - **余弦相似度**：将用户对物品的评分看作向量，通过计算两个用户向量之间的余弦夹角来衡量他们的相似度。公式为：
$$
sim(u,v)=\frac{\sum_{i\in I}(r_{ui} \times r_{vi})}{\sqrt{\sum_{i\in I}r_{ui}^2} \times \sqrt{\sum_{i\in I}r_{vi}^2}}
$$
	其中，\(u\)和\(v\)是两个用户，\(I\)是所有物品的集合，\(r_{ui}\)和\(r_{vi}\)分别是用户\(u\)和\(v\)对物品\(i\)的评分。
	- **皮尔逊相关系数**：衡量两个变量之间的线性相关程度，也可用于计算用户相似度。公式为：
$$
sim(u,v)=\frac{\sum_{i\in I}(r_{ui}-\bar{r_u})(r_{vi}-\bar{r_v})}{\sqrt{\sum_{i\in I}(r_{ui}-\bar{r_u})^2} \times \sqrt{\sum_{i\in I}(r_{vi}-\bar{r_v})^2}}
$$
其中，$\bar{r_u}$和$\bar{r_v}$分别是用户$u$和$v$对所有物品评分的平均值。
2. **邻居选择**
根据计算出的用户相似度，选取与目标用户相似度较高的前\(k\)个用户作为邻居，这些邻居将用于后续的推荐预测。

## 三、推荐预测
1. **基于用户的协同过滤**
对于目标用户\(u\)未评分的物品\(i\)，预测其评分公式为：
$$
\hat{r}_{ui}=\bar{r_u}+\frac{\sum_{v\in N(u)}sim(u,v)(r_{vi}-\bar{r_v})}{\sum_{v\in N(u)}sim(u,v)}
$$
其中，\(N(u)\)是目标用户\(u\)的邻居集合，\(\bar{r_u}\)和\(\bar{r_v}\)分别是用户\(u\)和邻居\(v\)的平均评分。
根据预测评分对未评分物品进行排序，推荐评分较高的物品给目标用户。
2. **基于物品的协同过滤**
首先计算物品之间的相似度，可使用余弦相似度等方法，例如对于物品\(i\)和\(j\)，相似度计算为：
$$
sim(i,j)=\frac{\sum_{u\in U}(r_{ui} \times r_{uj})}{\sqrt{\sum_{u\in U}r_{ui}^2} \times \sqrt{\sum_{u\in U}r_{uj}^2}}
$$
其中，\(U\)是所有用户的集合。
对于目标用户\(u\)未评分的物品\(i\)，预测其评分公式为：
$$
\hat{r}_{ui}=\frac{\sum_{j\in S(i)}sim(i,j)r_{uj}}{\sum_{j\in S(i)}sim(i,j)}
$$
其中，\(S(i)\)是与物品\(i\)相似的物品集合，\(r_{uj}\)是用户\(u\)对物品\(j\)的评分。同样，根据预测评分进行物品推荐。

 

以上是协同过滤的基本流程，在实际应用中可能会根据具体情况进行适当的调整和优化，你是否还有其他关于协同过滤的具体问题或者想要补充的细节信息呢？